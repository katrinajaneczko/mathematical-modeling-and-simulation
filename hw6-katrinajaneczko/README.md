# MATH2121 -- Homework #6
Katrina Janeczko

Spring 2022

### (a) Change the initial velocities of vehicles to v = (1:n)’. Explain what this change represents.

a) Originally, `v = rand(size(q))` creates a vector of the same size as q, where q determines the positions of the vehicles. Then v is a column vector which holds the velocities corresponding to each vehicle on the road, and in this case there are 22 vehicles, and we set each vehicle to have a random velocity between 0 and 1 m/s. Then at the first time step, the vehicles all have a velocity less than 0, and they all speed up pretty quickly to an average of around 9 m/s. But then changing it to `v = (1:n)'`, while also creating a column vector of 22 vehicle velocities, makes it so that each vehicle has an initial velocity corresponding to what order it appears on the road; so, the first vehicle begins with velocity 1 m/s, the second with velocity 2 m/s, and so on until the 22nd vehicle begins with velocity 22 m/2. The behavior this causes is that the faster vehicles get very close to the vehicle in front of them very quickly (since the vehicles are all travelling in a circle, so the slowest vehicle is in front of the faster vehicle) and must slow down quickly to compensate. So, we see in the figure on the right that the dots "fall" very quickly to low velocities, before then speeding up again as they leave the traffic. And in the figure on the left we see cars "piling up" into a line of very slow-moving traffic in a portion of the circle before speeding up again.

### (b) Now change the time step dt to 0.1, and the number of compute steps per plotting event np to 1. (...) Running the code should produce a weird behavior. Explain what happens and why.

Changing the time step size `dt` from 1 second to 0.1 second and changing the number of compute steps per plotting event `np` from 10 to 1 means that the same time is passing between plotting events (since `1 s * 10 = 10 s` and also `0.1 s * 1 = 10 s`), but now we have decreased the number of time steps that occur from 10 time steps to 1 time step. From Homework 5, we know that decreasing the number of time steps results in less accuracy due to error. The method being used to evaluate the forward step is the Euler Method, which we know to be a first order method, and so the error is

Now, the weird behavior produced is that cars seem to be running into or going through one another, or accelerating off the plot or stopping completely. This behavior is odd and should not be occurring, but since we are using a first order method (Euler's Method) to compute the positions, we know that with less time steps, we have more error, and so the behavior we are viewing in the plotting is not an accurate reflection of the true behavior of the function f at these points in time. 

### (c) For the previous code, change the time stepping from Euler’s method to Runge-Kutta 4. (...) explain why the new time stepping fixes the problem encountered in (b).

This fixed the weird behavior from part (b) since that behavior was caused by using Euler's Method instead of a higher order method, which produced a lot of error and caused the plotting to appear very different from the true behavior in accordance with the function. From Homework 5, we know Euler's global error is O(dt). So, with Euler, the number of time steps is too small to be accurate enough and to able to resolve the dynamics of this system well. But Runge-Kutta 4, being a fourth order method and so having global error O(dt^4), has a much higher accuracy for less steps. This is because this method finds the slopes of the tangents at four points between the left and right ends of each time step interval, then averages them to be used in calculating the next point. However, Euler's Method only looks at the interval's left side's tangent slope information and approximates the behavior at the next point. Additinally, note that over a large number of steps, the error accumulates more and more and the estimate diverges from the actual function value much more for Euler's than for Runge-Kutta 4. So, Runge-Kutta 4 results in a much closer-to-true approximation when compared to the true function `f` than Euler's Method when using a time step of .1. Especially since the function changes a lot across its domain, Euler simply cannot capture the behavior accurately (unless the tiime step is size is reduced very significantly). 

### (d) Change your code from part (c) to have dt = 1e-2 and np = 10 again, but keep the Runge-Kutta 4 time stepping. With this code, conduct a parameter study how the characteristics of the traffic wave depend on the strength of the optimal velocity term. Specifically, vary the coefficient (which is 0.5 in the original file) in front of the term from 0 to 2, in steps of 0.05. Describe your observations and explain the result. 

Call the coefficient that modifies the velocity term (which changes from 0 to 2 by steps of 0.05) `a`. We produce the following plot:
<br><img width="550" alt="Screen Shot 2022-03-23 at 6 59 12 PM" src="https://user-images.githubusercontent.com/73796086/159810097-e3b10bc0-674f-4f42-a387-bea45cc035d3.png"><br>

We observe that for very small values of `a`, the model is very close to the follow the leader model. We see that when `a=0`, the optimal velocity term (the second term in the equation `f`) has no influence, which makes sense since we then see the behavior of the plot displaying that of the follow the leader model in this case (since that model had no optimal velocity term at all in it). This is why the maximum and minimum final velocities (`umax` and `umin` respectively) are the same, since we observe from the plot that `umin=4` and `umax=4 m/s` approximately. So it seems to be a stable model when `a=0`, since this is the behavior resulting from the follow the leader model with the same parameters of dt and np, since cars are not concerned with optimal velocity and their behavior depends only on the behavior of the car in front of them. When the value of a jumps from 0 to .05, we see a big jump in both umin and umax up to `umin=7.5 m/s` and `umax=9.2 m/s` approximately. This jump occurs since we have now introduced the coefficient `a` as a nonzero number, so that the optimal velocity term is now affecting the vehicles' velocities. Then, we see that between about `a=.05` to about `a=1.25`, that umin has a drastic concave-up shape, which shows that there are very fast vehicles and very slow vehicles present on the road simultaneously, since the final values for umin and umax at tf are drastically different. So, a traffic wave is occuring, and we are left with an unstable model. Then, we observe that around `a=1.25`, the values for umin and umax begin to converge again, specifically to a value of about `8.7 m/s` where it remains for values of a greater than 1.25. Now, we have a stable model again, showing that for larger values of a greater than 1.25, increasing the value of a any further does not change the behavior of the model. 

